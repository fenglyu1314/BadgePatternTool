# BadgePatternTool - 徽章图案工具

一个用于制作徽章的图片处理和排版工具，支持将用户图片裁剪成68mm直径圆形并在A4纸上自动排版。

## 🎯 功能特性

- **图片批量导入**: 支持JPG、PNG等常用格式，带缩略图预览
- **圆形裁剪**: 精确裁剪成68mm直径圆形
- **手动调整**: 支持缩放和移动调整裁剪区域
- **数量控制**: 为每张图片设置在画布上的出现次数
- **A4排版**: 自动排版到A4纸，支持网格和六边形蜂巢排列
- **交互预览**: 鼠标滚轮缩放、拖动平移的专业预览体验
- **高质量输出**: 300DPI打印质量，支持PDF、PNG、JPG格式
- **性能优化**: 防抖机制确保流畅的操作体验

## 🚀 快速开始

### 环境要求
- Python 3.8+
- Windows 7/8/10/11

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行程序
```bash
python src/main.py
```

### 测试功能
```bash
# 快速集成测试
python tests/test_integration.py

# 完整测试套件
python tests/run_tests.py

# 使用开发工具
python scripts/dev_tools.py test
```

## 📖 使用指南

### 基本工作流程

1. **导入图片**
   - 点击"导入图片"按钮或使用菜单"文件 → 导入图片"
   - 选择一张或多张图片文件
   - 支持格式：JPG、PNG、BMP、GIF、TIFF

2. **编辑图片**
   - 在左侧列表中选择图片（支持缩略图预览）
   - 切换到"单图编辑"标签页
   - 使用滑块调整缩放和位置（优化了响应性能）
   - 设置该图片在画布上的数量
   - 点击"应用"保存编辑参数

3. **预览排版**
   - 切换到"A4排版预览"标签页
   - 选择排列模式（网格/六边形蜂巢）
   - 调整间距和页边距
   - 使用鼠标滚轮缩放、拖动查看细节
   - 实时查看排版效果

4. **导出文件**
   - 点击"自动排版"为所有图片应用最佳参数
   - 选择导出格式（PDF/PNG/JPG）
   - 点击"导出文件"保存结果

### 界面说明

- **左侧面板**: 图片列表管理（带缩略图），导入、删除、清空操作
- **中间区域**: 双标签页设计
  - 单图编辑：圆形预览、参数调整和数量设置
  - A4排版预览：交互式排版效果展示（支持缩放和拖动）
- **右侧面板**: 参数设置和导出控制

## 📁 项目结构

```
BadgePatternTool/
├── src/
│   ├── main.py              # 主程序入口
│   ├── ui/                  # 界面模块
│   │   ├── main_window.py   # 主窗口
│   │   └── interactive_preview_label.py # 交互预览组件
│   ├── core/                # 核心业务逻辑
│   │   ├── image_processor.py # 图片处理
│   │   ├── layout_engine.py   # 排版引擎
│   │   └── export_manager.py  # 导出管理
│   ├── utils/               # 工具函数
│   │   ├── config.py        # 配置管理
│   │   └── file_handler.py  # 文件处理
│   └── assets/              # 资源文件
├── docs/                    # 项目文档
│   ├── 需求文档.md          # 详细需求文档
│   ├── 测试文档.md          # 功能测试指南
│   ├── 打印功能使用指南.md  # 打印功能说明
│   └── Git使用指南.md       # 版本控制指南
├── tests/                   # 测试模块
│   ├── __init__.py         # 测试包初始化
│   ├── test_core.py        # 核心功能测试
│   ├── test_utils.py       # 工具模块测试
│   ├── test_integration.py # 集成测试
│   └── run_tests.py        # 测试运行器
├── scripts/                 # 开发脚本
│   ├── dev_tools.py        # 开发工具
│   ├── build.py            # 构建脚本
│   └── check_code_quality.py # 代码质量检查
├── requirements.txt         # 依赖列表
├── CHANGELOG.md            # 更新日志
└── README.md               # 项目说明
```

## 📋 开发状态

当前版本: v1.0.0 (MVP完成)

### ✅ 已完成功能
- [x] **现代化GUI**: 基于PySide6的专业界面设计
- [x] **图片导入管理**: 多格式支持，批量导入，文件验证
- [x] **圆形图片编辑**: 实时预览，精确缩放，位置调整
- [x] **A4智能排版**: 网格/紧密排列，自动计算最优位置
- [x] **多格式导出**: 高质量PDF/PNG/JPG，300DPI打印级别
- [x] **参数控制**: 间距调节，页边距设置，预览缩放
- [x] **自动排版**: 一键优化所有图片参数
- [x] **实时预览**: 所见即所得的编辑体验

### 🎯 核心特性
- **完整工作流程**: 导入 → 编辑 → 排版 → 导出
- **高质量输出**: 300DPI打印级别，专业品质
- **用户友好**: 直观的界面和实时预览反馈
- **灵活排版**: 支持网格和紧密两种排列模式
- **跨平台**: 支持Windows、macOS、Linux

## 🛠️ 技术架构

### 技术栈
- **GUI框架**: PySide6 (Qt6) - 现代化跨平台界面
- **图像处理**: Pillow (PIL) - 专业图像处理库
- **PDF生成**: ReportLab - 高质量PDF输出
- **数学计算**: NumPy - 高效数值计算

### 设计特点
- **模块化架构**: 清晰的代码结构，易于维护和扩展
- **MVC模式**: 分离界面、逻辑和数据层
- **错误处理**: 完善的异常处理和用户反馈
- **性能优化**: 高效的图像处理和内存管理

## 🛠️ 开发工具

项目提供了完整的开发工具链：

### 快速命令
```bash
# 运行应用程序
python scripts/dev_tools.py run

# 运行测试
python scripts/dev_tools.py test

# 检查代码质量
python scripts/dev_tools.py quality

# 构建可执行文件
python scripts/dev_tools.py build

# 安装依赖
python scripts/dev_tools.py install
```

### 测试框架
- **单元测试**: `tests/test_core.py`, `tests/test_utils.py`
- **集成测试**: `tests/test_integration.py`
- **测试运行器**: `tests/run_tests.py`

### 代码质量
- 自动语法检查
- 导入语句规范检查
- 文档字符串完整性检查
- 项目结构验证

## 📄 许可证

本项目仅供学习和个人使用。

---

*开发时间: 2025-06-17*
