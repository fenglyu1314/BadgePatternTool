# BadgePatternTool 需求文档

## 📋 项目概述

**工具名称**: BadgePatternTool
**版本**: v1.4.0
**开发语言**: Python
**GUI框架**: PySide6
**目标**: 制作徽章图片处理和A4排版工具，支持批量处理和个性化调整

> **注意**: 本文档记录了项目的原始需求和设计思路，当前项目已基于PySide6实现，部分技术选型已更新。

---

## 📊 详细功能需求

### 1. 图片导入模块
- **支持格式**: JPG, PNG (主要)，兼容其他常用格式
- **导入方式**: 批量选择多张图片
- **文件管理**: 显示已导入图片列表，支持删除和重新排序

### 2. 图片裁剪编辑模块
- **裁剪形状**: 固定直径68mm的正圆形
- **手动调整功能**:
  - ✅ 缩放：鼠标滚轮或滑块调整图片大小
  - ✅ 移动：拖拽调整图片在圆形内的位置
  - ✅ 实时预览：显示裁剪效果
- **个别编辑**: 每个圆形图片可单独调整
- **操作便捷性**: 双击进入编辑模式

### 3. A4排版模块
- **预设布局方案**:
  - 网格排列：规整的行列布局
  - 紧密排列：最大化利用空间
- **参数调整**:
  - 圆形间距：可调节圆与圆之间的距离
  - 页边距：A4纸边缘留白
  - 每页数量：自动计算或手动设置
- **排版预览**: 实时显示A4排版效果

### 4. 导出模块
- **输出格式**: PDF（主要）、PNG、JPG
- **质量设置**: 300DPI打印质量
- **文件命名**: 自动生成带时间戳的文件名
- **批量处理**: 支持多页PDF或多个图片文件

---

## 🎯 核心功能特性

### ✅ 已实现功能
1. **现代化GUI**: 基于PySide6的专业界面设计
2. **图片导入管理**: 多格式支持，批量导入，文件验证
3. **圆形图片编辑**: 实时预览，精确缩放，位置调整
4. **A4智能排版**: 网格/紧密排列，自动计算最优位置
5. **多格式导出**: 高质量PDF/PNG/JPG，300DPI打印级别
6. **参数控制**: 间距调节，页边距设置，预览缩放
7. **自动排版**: 一键优化所有图片参数
8. **实时预览**: 所见即所得的编辑体验
9. **打印功能**: 直接打印和打印预览
10. **性能优化**: 防抖机制，流畅操作体验

---

## 🛠️ 技术架构

### 当前技术栈
```python
# 核心技术选型
GUI框架: PySide6 (现代化Qt界面)
图像处理: Pillow (PIL) - 完美支持圆形裁剪
排版计算: 自定义算法
PDF生成: reportlab
打包工具: PyInstaller (生成单文件exe)
```

### 项目结构
```
BadgePatternTool/
├── src/
│   ├── main.py              # 主程序入口
│   ├── ui/
│   │   ├── main_window.py   # 主窗口
│   │   └── interactive_preview_label.py # 交互预览组件
│   ├── core/
│   │   ├── image_processor.py # 图片处理核心
│   │   ├── layout_engine.py   # 排版引擎
│   │   └── export_manager.py  # 导出管理
│   ├── utils/
│   │   ├── file_handler.py    # 文件操作
│   │   └── config.py          # 配置管理
│   └── assets/              # 图标资源
├── docs/                    # 项目文档
├── requirements.txt         # 依赖列表
└── test_app.py             # 功能测试
```

---

## 📝 开发任务拆解

### 第一阶段：基础框架 ✅
- [x] 项目结构搭建
- [x] PySide6界面框架
- [x] 配置管理系统
- [x] 基础文件处理

### 第二阶段：核心功能 ✅
- [x] 图片导入和验证
- [x] 圆形裁剪算法
- [x] 排版引擎实现
- [x] 导出功能开发

### 第三阶段：界面优化 ✅
- [x] 用户界面完善
- [x] 交互体验优化
- [x] 预览功能增强
- [x] 错误处理完善

### 第四阶段：高级功能 ✅
- [x] 打印功能集成
- [x] 性能优化
- [x] 用户体验提升
- [x] 文档完善

---

## 🎨 界面设计要求

### 布局原则
- **简洁明了**: 避免复杂的界面元素
- **功能分区**: 清晰的功能区域划分
- **操作直观**: 符合用户习惯的交互方式

### 具体要求
- 固定窗口大小，四列布局
- 图片列表支持缩略图预览
- 实时预览编辑效果
- A4预览支持缩放和拖拽
- 响应式控件，防抖优化

---

## 📊 性能要求

- **启动时间**: < 3秒
- **图片处理**: 单张图片处理 < 1秒
- **预览更新**: 实时响应，无明显延迟
- **内存占用**: < 200MB（正常使用）
- **文件大小**: 打包后 < 50MB

---

## 🔧 部署要求

- **绿色软件**: 无需安装，解压即用
- **兼容性**: Windows 7/8/10/11
- **依赖最小化**: 内置所有必要组件
- **更新机制**: 支持版本检查和更新提示

---

*需求文档版本：v1.0*  
*创建时间：2025-06-17*  
*最后更新：2025-06-17*
