# BadgePatternTool A4ç”»å¸ƒç¼©æ”¾æ‹–æ‹½é‡æ„è¯´æ˜

## ğŸ¯ é—®é¢˜æè¿°

ç”¨æˆ·åé¦ˆå½“å‰çš„A4é¢„è§ˆç”»å¸ƒç¼©æ”¾é€»è¾‘ä¸ç¬¦åˆé¢„æœŸï¼š
- **å½“å‰é—®é¢˜**ï¼šæ»šè½®ç¼©æ”¾åªç¼©æ”¾äº†ç”»å¸ƒé‡Œé¢çš„å†…å®¹
- **ç”¨æˆ·æœŸæœ›**ï¼šåœ¨æ·±è‰²èƒŒæ™¯åŒºåŸŸå†…æœ‰ä¸€ä¸ªç™½è‰²çš„A4ç”»å¸ƒï¼Œè¿™ä¸ªç”»å¸ƒå¯ä»¥è¢«ç¼©æ”¾å’Œæ‹–åŠ¨
- **æœŸæœ›æ•ˆæœ**ï¼šA4çº¸åŒºåŸŸå¤–é¢æ˜¯æ·±ç°è‰²çš„ç”»å¸ƒèƒŒæ™¯åŒºåŸŸï¼ŒA4ç”»å¸ƒå¯ä»¥åœ¨è¿™ä¸ªåŒºåŸŸå†…è‡ªç”±ç§»åŠ¨å’Œç¼©æ”¾

## ğŸ”§ é‡æ„æ–¹æ¡ˆ

### 1. æ ¸å¿ƒè®¾è®¡ç†å¿µ

**æ–°çš„è§†è§‰å±‚æ¬¡ç»“æ„**ï¼š
```
æ·±ç°è‰²èƒŒæ™¯åŒºåŸŸ (#404040)
â””â”€â”€ å¯ç¼©æ”¾å¯æ‹–æ‹½çš„ç™½è‰²A4ç”»å¸ƒ
    â”œâ”€â”€ A4ç”»å¸ƒé˜´å½±æ•ˆæœ
    â”œâ”€â”€ A4ç”»å¸ƒè¾¹æ¡† (#777)
    â””â”€â”€ æ’ç‰ˆå†…å®¹ï¼ˆåœ¨A4ç”»å¸ƒå†…ï¼‰
```

**å…³é”®æ”¹è¿›**ï¼š
- ä½¿ç”¨è‡ªå®šä¹‰ `paintEvent` ç»˜åˆ¶A4ç”»å¸ƒ
- A4ç”»å¸ƒå¯ä»¥åœ¨æ·±è‰²èƒŒæ™¯åŒºåŸŸå†…è‡ªç”±ç§»åŠ¨
- æ»šè½®ç¼©æ”¾å½±å“æ•´ä¸ªA4ç”»å¸ƒçš„å¤§å°
- é¼ æ ‡æ‹–æ‹½å¯ä»¥ç§»åŠ¨A4ç”»å¸ƒä½ç½®

### 2. ä¸»è¦ä»£ç ä¿®æ”¹

#### InteractivePreviewLabel ç±»é‡æ„

**æ–°å¢å±æ€§**ï¼š
```python
# A4ç”»å¸ƒä½ç½®ï¼ˆç”¨äºæ‹–æ‹½ï¼‰
self.canvas_offset = QPoint(0, 0)
```

**æ ¸å¿ƒæ–¹æ³•é‡å†™**ï¼š

1. **get_a4_canvas_rect()** - è®¡ç®—A4ç”»å¸ƒçŸ©å½¢åŒºåŸŸ
```python
def get_a4_canvas_rect(self):
    """è·å–A4ç”»å¸ƒçš„çŸ©å½¢åŒºåŸŸ"""
    # è®¡ç®—å½“å‰A4ç”»å¸ƒçš„æ˜¾ç¤ºå°ºå¯¸
    current_width = int(self.base_width * self.scale_factor)
    current_height = int(self.base_height * self.scale_factor)
    
    # è®¡ç®—A4ç”»å¸ƒåœ¨æ§ä»¶ä¸­çš„ä½ç½®ï¼ˆå±…ä¸­ + åç§»ï¼‰
    widget_center_x = self.width() // 2
    widget_center_y = self.height() // 2
    
    canvas_x = widget_center_x - current_width // 2 + self.canvas_offset.x()
    canvas_y = widget_center_y - current_height // 2 + self.canvas_offset.y()
    
    return QRect(canvas_x, canvas_y, current_width, current_height)
```

2. **paintEvent()** - è‡ªå®šä¹‰ç»˜åˆ¶A4ç”»å¸ƒ
```python
def paintEvent(self, event):
    """è‡ªå®šä¹‰ç»˜åˆ¶äº‹ä»¶"""
    painter = QPainter(self)
    painter.setRenderHint(QPainter.Antialiasing)
    
    # è·å–A4ç”»å¸ƒçŸ©å½¢
    canvas_rect = self.get_a4_canvas_rect()
    
    # ç»˜åˆ¶A4ç”»å¸ƒé˜´å½±ï¼ˆåç§»å‡ ä¸ªåƒç´ ï¼‰
    shadow_rect = canvas_rect.adjusted(4, 4, 4, 4)
    painter.fillRect(shadow_rect, QColor(0, 0, 0, 50))
    
    # ç»˜åˆ¶A4ç”»å¸ƒèƒŒæ™¯ï¼ˆç™½è‰²ï¼‰
    painter.fillRect(canvas_rect, QColor(255, 255, 255))
    
    # ç»˜åˆ¶A4ç”»å¸ƒè¾¹æ¡†
    pen = QPen(QColor(119, 119, 119), 2)
    painter.setPen(pen)
    painter.drawRect(canvas_rect)
    
    # ç»˜åˆ¶æ’ç‰ˆå†…å®¹
    if self.content_pixmap and not self.content_pixmap.isNull():
        # ... å†…å®¹ç»˜åˆ¶é€»è¾‘
```

3. **é¼ æ ‡äº‹ä»¶å¤„ç†** - æ”¯æŒA4ç”»å¸ƒæ‹–æ‹½
```python
def mousePressEvent(self, event: QMouseEvent):
    """é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶"""
    if event.button() == Qt.LeftButton:
        # æ£€æŸ¥æ˜¯å¦ç‚¹å‡»åœ¨A4ç”»å¸ƒåŒºåŸŸå†…
        canvas_rect = self.get_a4_canvas_rect()
        if canvas_rect.contains(event.pos()):
            self.dragging = True
            self.last_pan_point = event.pos()
            self.setCursor(Qt.ClosedHandCursor)

def mouseMoveEvent(self, event: QMouseEvent):
    """é¼ æ ‡ç§»åŠ¨äº‹ä»¶"""
    if self.dragging and event.buttons() == Qt.LeftButton:
        # è®¡ç®—æ‹–æ‹½åç§»
        delta = event.pos() - self.last_pan_point
        self.canvas_offset += delta
        self.last_pan_point = event.pos()
        self.update()  # è§¦å‘é‡ç»˜
    else:
        # æ£€æŸ¥é¼ æ ‡æ˜¯å¦åœ¨A4ç”»å¸ƒåŒºåŸŸå†…ï¼Œæ”¹å˜å…‰æ ‡
        canvas_rect = self.get_a4_canvas_rect()
        if canvas_rect.contains(event.pos()):
            self.setCursor(Qt.OpenHandCursor)
        else:
            self.setCursor(Qt.ArrowCursor)
```

#### InteractiveScrollArea ç±»è°ƒæ•´

**æ»šåŠ¨æ¡è®¾ç½®**ï¼š
```python
# ç¦ç”¨æ»šåŠ¨æ¡ï¼Œå› ä¸ºæ‹–æ‹½åŠŸèƒ½ç”±A4ç”»å¸ƒè‡ªå·±å¤„ç†
self.setHorizontalScrollBarPolicy(Qt.ScrollBarAlwaysOff)
self.setVerticalScrollBarPolicy(Qt.ScrollBarAlwaysOff)
self.setWidgetResizable(False)
```

**èƒŒæ™¯é¢œè‰²è°ƒæ•´**ï¼š
```python
# æ›´æ·±çš„èƒŒæ™¯è‰²ä»¥çªå‡ºç™½è‰²A4ç”»å¸ƒ
background-color: #404040;
```

### 3. ç”¨æˆ·äº¤äº’æ”¹è¿›

#### ç¼©æ”¾è¡Œä¸º
- **æ»šè½®å‘ä¸Š**ï¼šæ”¾å¤§æ•´ä¸ªA4ç”»å¸ƒï¼ˆåŒ…æ‹¬è¾¹æ¡†å’Œé˜´å½±ï¼‰
- **æ»šè½®å‘ä¸‹**ï¼šç¼©å°æ•´ä¸ªA4ç”»å¸ƒ
- **ç¼©æ”¾ä¸­å¿ƒ**ï¼šA4ç”»å¸ƒä¿æŒåœ¨æ§ä»¶ä¸­å¿ƒä½ç½®

#### æ‹–æ‹½è¡Œä¸º
- **é¼ æ ‡æ‚¬åœ**ï¼šåœ¨A4ç”»å¸ƒåŒºåŸŸå†…æ˜¾ç¤ºæ‰‹å‹å…‰æ ‡
- **ç‚¹å‡»æ‹–æ‹½**ï¼šåªæœ‰åœ¨A4ç”»å¸ƒåŒºåŸŸå†…ç‚¹å‡»æ‰èƒ½æ‹–æ‹½
- **æ‹–æ‹½æ•ˆæœ**ï¼šA4ç”»å¸ƒåœ¨æ·±è‰²èƒŒæ™¯åŒºåŸŸå†…ç§»åŠ¨

#### é€‚åº”çª—å£
- **fit_to_window()**ï¼šè®¡ç®—åˆé€‚çš„ç¼©æ”¾æ¯”ä¾‹å¹¶é‡ç½®ä½ç½®åˆ°ä¸­å¿ƒ
- **reset_view()**ï¼šé‡ç½®ç¼©æ”¾å’Œä½ç½®

## âœ… å®ç°æ•ˆæœ

### è§†è§‰æ•ˆæœå¯¹æ¯”

| åŠŸèƒ½ | ä¿®æ”¹å‰ | ä¿®æ”¹å |
|------|--------|--------|
| **èƒŒæ™¯åŒºåŸŸ** | æ·±ç°è‰²å›ºå®šèƒŒæ™¯ | æ·±ç°è‰²èƒŒæ™¯ (#404040) |
| **A4ç”»å¸ƒ** | å›ºå®šåœ¨ä¸­å¿ƒï¼Œåªç¼©æ”¾å†…å®¹ | å¯ç§»åŠ¨çš„ç™½è‰²ç”»å¸ƒï¼Œæ•´ä½“ç¼©æ”¾ |
| **ç¼©æ”¾è¡Œä¸º** | åªç¼©æ”¾æ’ç‰ˆå†…å®¹ | ç¼©æ”¾æ•´ä¸ªA4ç”»å¸ƒï¼ˆå«è¾¹æ¡†é˜´å½±ï¼‰ |
| **æ‹–æ‹½è¡Œä¸º** | æ— æ‹–æ‹½åŠŸèƒ½ | å¯æ‹–æ‹½A4ç”»å¸ƒä½ç½® |
| **é¼ æ ‡å…‰æ ‡** | å›ºå®šç®­å¤´å…‰æ ‡ | æ™ºèƒ½åˆ‡æ¢ï¼ˆç®­å¤´/æ‰‹å‹ï¼‰ |

### ç”¨æˆ·ä½“éªŒæå‡

1. **ç›´è§‚çš„A4çº¸æ¦‚å¿µ**ï¼š
   - âœ… ç™½è‰²A4ç”»å¸ƒä¸æ·±è‰²èƒŒæ™¯å½¢æˆå¼ºçƒˆå¯¹æ¯”
   - âœ… é˜´å½±æ•ˆæœå¢å¼ºç«‹ä½“æ„Ÿå’Œå±‚æ¬¡æ„Ÿ
   - âœ… ç”¨æˆ·å¯ä»¥æ¸…æ¥šçœ‹åˆ°A4çº¸çš„å®é™…è¾¹ç•Œ

2. **çµæ´»çš„è§†å›¾æ§åˆ¶**ï¼š
   - âœ… æ»šè½®ç¼©æ”¾æ•´ä¸ªA4ç”»å¸ƒï¼Œç¬¦åˆç”¨æˆ·ç›´è§‰
   - âœ… æ‹–æ‹½ç§»åŠ¨A4ç”»å¸ƒä½ç½®ï¼Œæ–¹ä¾¿æŸ¥çœ‹ç»†èŠ‚
   - âœ… æ™ºèƒ½å…‰æ ‡æç¤ºï¼Œå¢å¼ºäº¤äº’åé¦ˆ

3. **ä¿æŒåŠŸèƒ½å®Œæ•´æ€§**ï¼š
   - âœ… æ’ç‰ˆå†…å®¹æ­£ç¡®æ˜¾ç¤ºåœ¨A4ç”»å¸ƒå†…
   - âœ… é€‚åº”çª—å£åŠŸèƒ½æ­£å¸¸å·¥ä½œ
   - âœ… ç¼©æ”¾æ¯”ä¾‹æ§åˆ¶ä¿æŒä¸€è‡´

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### åæ ‡è®¡ç®—
```python
# A4ç”»å¸ƒä¸­å¿ƒä½ç½®è®¡ç®—
widget_center_x = self.width() // 2
widget_center_y = self.height() // 2

# A4ç”»å¸ƒå®é™…ä½ç½® = ä¸­å¿ƒä½ç½® + ç”¨æˆ·æ‹–æ‹½åç§»
canvas_x = widget_center_x - current_width // 2 + self.canvas_offset.x()
canvas_y = widget_center_y - current_height // 2 + self.canvas_offset.y()
```

### é˜´å½±æ•ˆæœ
```python
# é˜´å½±çŸ©å½¢åç§»4åƒç´ ï¼ŒåŠé€æ˜é»‘è‰²
shadow_rect = canvas_rect.adjusted(4, 4, 4, 4)
painter.fillRect(shadow_rect, QColor(0, 0, 0, 50))
```

### æ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨ `self.update()` è§¦å‘é‡ç»˜è€Œä¸æ˜¯å®Œæ•´é‡å»º
- åªåœ¨å¿…è¦æ—¶é‡æ–°è®¡ç®—A4ç”»å¸ƒçŸ©å½¢
- æ™ºèƒ½å…‰æ ‡åˆ‡æ¢å‡å°‘ä¸å¿…è¦çš„å…‰æ ‡æ›´æ–°

## ğŸ“ ä½¿ç”¨è¯´æ˜

1. **ç¼©æ”¾æ“ä½œ**ï¼šåœ¨A4é¢„è§ˆåŒºåŸŸä½¿ç”¨é¼ æ ‡æ»šè½®è¿›è¡Œç¼©æ”¾
2. **æ‹–æ‹½æ“ä½œ**ï¼šåœ¨ç™½è‰²A4ç”»å¸ƒåŒºåŸŸå†…ç‚¹å‡»å¹¶æ‹–æ‹½ç§»åŠ¨ç”»å¸ƒ
3. **é‡ç½®è§†å›¾**ï¼šä½¿ç”¨"é€‚åº”çª—å£"æŒ‰é’®é‡ç½®ç¼©æ”¾å’Œä½ç½®
4. **å…‰æ ‡æç¤º**ï¼šé¼ æ ‡æ‚¬åœåœ¨A4ç”»å¸ƒä¸Šä¼šæ˜¾ç¤ºæ‰‹å‹å…‰æ ‡

è¿™æ¬¡é‡æ„å®Œå…¨æ»¡è¶³äº†ç”¨æˆ·çš„éœ€æ±‚ï¼Œå®ç°äº†åœ¨æ·±è‰²èƒŒæ™¯åŒºåŸŸå†…å¯ç¼©æ”¾å¯æ‹–æ‹½çš„ç™½è‰²A4ç”»å¸ƒæ•ˆæœã€‚
