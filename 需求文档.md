# BadgePatternTool 需求文档

## 📋 项目概述

**工具名称**: BadgePatternTool  
**版本**: v1.0  
**开发语言**: Python  
**目标**: 制作徽章图片处理和A4排版工具，支持批量处理和个性化调整

---

## 📊 详细功能需求

### 1. 图片导入模块
- **支持格式**: JPG, PNG (主要)，兼容其他常用格式
- **导入方式**: 批量选择多张图片
- **文件管理**: 显示已导入图片列表，支持删除和重新排序

### 2. 图片裁剪编辑模块
- **裁剪形状**: 固定直径68mm的正圆形
- **手动调整功能**:
  - ✅ 缩放：鼠标滚轮或滑块调整图片大小
  - ✅ 移动：拖拽调整图片在圆形内的位置
  - ✅ 实时预览：显示裁剪效果
- **个别编辑**: 每个圆形图片可单独调整
- **操作便捷性**: 双击进入编辑模式

### 3. A4排版模块
- **预设布局方案**:
  - 网格排列：规整的行列布局
  - 紧密排列：最大化利用空间
- **参数调整**:
  - 圆形间距：可调节圆与圆之间的距离
  - 页边距：A4纸边缘留白
  - 每页数量：自动计算或手动设置
- **排版预览**: 实时显示A4排版效果

### 4. 输出导出模块
- **输出格式**: PDF（推荐）、PNG、JPG
- **输出质量**: 300DPI打印质量
- **文件命名**: 自动生成或用户自定义
- **保存选项**: 选择保存路径

---

## 🎨 界面设计要求

### 界面风格
- **简洁实用**: 功能明确，操作直观
- **布局清晰**: 左侧图片列表，中间编辑区，右侧参数面板
- **响应式**: 支持窗口大小调整

### 主要界面区域
```
┌─────────────────────────────────────────────────────┐
│  菜单栏: 文件 编辑 视图 帮助                          │
├─────────────┬─────────────────────┬─────────────────┤
│             │                     │                 │
│  图片列表    │    编辑预览区        │   参数设置面板   │
│  - 导入按钮  │  - 单个图片编辑      │  - 布局选择     │
│  - 图片缩略图│  - A4排版预览       │  - 间距调整     │
│  - 删除功能  │  - 缩放/移动工具     │  - 输出设置     │
│             │                     │                 │
└─────────────┴─────────────────────┴─────────────────┘
```

---

## ⚙️ 技术方案

### 推荐技术栈
```python
# 核心技术选型
GUI框架: tkinter (轻量级，绿色安装)
图像处理: Pillow (PIL) - 完美支持圆形裁剪
排版计算: 自定义算法
PDF生成: reportlab
打包工具: PyInstaller (生成单文件exe)
```

### 项目结构
```
BadgePatternTool/
├── src/
│   ├── main.py              # 主程序入口
│   ├── ui/
│   │   ├── main_window.py   # 主窗口
│   │   ├── image_editor.py  # 图片编辑器
│   │   └── layout_preview.py# 排版预览
│   ├── core/
│   │   ├── image_processor.py # 图片处理核心
│   │   ├── layout_engine.py   # 排版引擎
│   │   └── export_manager.py  # 导出管理
│   ├── utils/
│   │   ├── file_handler.py    # 文件操作
│   │   └── config.py          # 配置管理
│   └── assets/              # 图标资源
├── requirements.txt
└── build.py                 # 打包脚本
```

---

## 📝 开发任务拆解

### 需求或问题1: 图片导入和基础界面
- **解决方案**: 使用tkinter创建主窗口，集成文件选择对话框，实现图片批量导入和缩略图显示
- **任务清单**：
  - [ ] 创建项目基础结构和配置文件
  - [ ] 实现主窗口布局设计
  - [ ] 开发图片导入功能（支持JPG/PNG）
  - [ ] 实现图片列表显示和管理功能
  - [ ] 添加基础的文件操作（删除、重排序）

### 需求或问题2: 图片裁剪编辑功能
- **解决方案**: 使用Pillow进行图像处理，创建交互式编辑界面，支持缩放、移动和实时预览
- **任务清单**：
  - [ ] 开发圆形裁剪算法（68mm直径）
  - [ ] 实现图片缩放功能（鼠标滚轮/滑块）
  - [ ] 实现图片拖拽移动功能
  - [ ] 创建实时预览显示
  - [ ] 添加编辑状态保存和恢复

### 需求或问题3: A4排版引擎
- **解决方案**: 开发自动排版算法，支持网格和紧密排列模式，提供参数调整接口
- **任务清单**：
  - [ ] 设计A4纸尺寸和68mm圆形的数学模型
  - [ ] 实现网格排列算法
  - [ ] 实现紧密排列算法
  - [ ] 开发间距和页边距调整功能
  - [ ] 创建排版预览界面

### 需求或问题4: 导出和打印功能
- **解决方案**: 集成reportlab生成高质量PDF，支持多种格式导出，确保打印质量
- **任务清单**：
  - [ ] 实现PDF导出功能（300DPI）
  - [ ] 添加PNG/JPG格式导出
  - [ ] 开发文件命名和保存路径选择
  - [ ] 实现导出进度提示
  - [ ] 添加导出质量验证

### 需求或问题5: 用户体验优化和打包
- **解决方案**: 优化界面交互，添加快捷键和提示信息，使用PyInstaller打包成绿色版
- **任务清单**：
  - [ ] 添加操作提示和帮助信息
  - [ ] 实现快捷键支持
  - [ ] 优化界面响应速度
  - [ ] 配置PyInstaller打包脚本
  - [ ] 测试绿色版运行和兼容性

### 注意事项:
1. **性能优化**: 大图片处理时避免界面卡顿，考虑多线程
2. **内存管理**: 批量处理时注意内存占用
3. **用户体验**: 提供操作反馈和错误提示
4. **兼容性**: 确保在不同Windows版本上正常运行

---

## 🚀 开发优先级

**第一阶段 (MVP)**:
- 基础界面 + 图片导入 + 简单裁剪 + 基础排版 + PDF导出

**第二阶段 (增强)**:
- 高级编辑功能 + 多种排版模式 + 参数调整

**第三阶段 (完善)**:
- 用户体验优化 + 性能提升 + 打包发布

---

## 📐 技术规格

### 尺寸规格
- **徽章直径**: 68mm
- **A4纸尺寸**: 210mm × 297mm
- **打印分辨率**: 300DPI
- **输出质量**: 高质量打印级别

### 性能要求
- **响应时间**: 界面操作 < 100ms
- **处理能力**: 支持同时处理20-50张图片
- **内存占用**: < 500MB (正常使用)
- **启动时间**: < 3秒

### 兼容性要求
- **操作系统**: Windows 7/8/10/11
- **Python版本**: 3.8+
- **依赖库**: 最小化外部依赖
- **安装方式**: 绿色版，无需安装

---

*文档创建时间: 2025-06-17*  
*版本: v1.0*
